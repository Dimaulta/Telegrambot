# ๐๏ธ ะััะธัะตะบัััะฐ ะฑะฐะท ะดะฐะฝะฝัั

## ๐ ะะฑัะฐั ะบะฐััะธะฝะฐ

ะ ะฟัะพะตะบัะต ะธัะฟะพะปัะทัะตััั **SQLite** (ัะฐะนะปะพะฒัะต ะฑะฐะทั ะดะฐะฝะฝัั). ะััั **ะพะฑัะฐั ะะ** ะดะปั ะผะพะฝะตัะธะทะฐัะธะธ ะธ **ะฒะฝัััะตะฝะฝะธะต ะะ** ะดะปั ะฝะตะบะพัะพััั ะฑะพัะพะฒ.

## ๐ต ะะฑัะฐั ะะ: `monetization.sqlite`

### ะะดะต ะฝะฐัะพะดะธััั:
```
config/monetization.sqlite
```

### ะัะพ ะธัะฟะพะปัะทัะตั:
- โ **NowControllerBot** - ัะพะทะดะฐะตั ะธ ัะฟัะฐะฒะปัะตั ะะ
- โ **Neurfotobot** - ะฟัะพะฒะตัะบะฐ ะฟะพะดะฟะธัะบะธ ะฝะฐ ะบะฐะฝะฐะปั
- โ **GSForTextBot** - ะฟัะพะฒะตัะบะฐ ะฟะพะดะฟะธัะบะธ ะฝะฐ ะบะฐะฝะฐะปั
- โ **ContentFabrikaBot** - ะฟัะพะฒะตัะบะฐ ะฟะพะดะฟะธัะบะธ ะฝะฐ ะบะฐะฝะฐะปั
- โ **NowmttBot** - ะฟัะพะฒะตัะบะฐ ะฟะพะดะฟะธัะบะธ ะฝะฐ ะบะฐะฝะฐะปั
- โ **PereskazNowBot** - ะฟัะพะฒะตัะบะฐ ะฟะพะดะฟะธัะบะธ ะฝะฐ ะบะฐะฝะฐะปั
- โ **Roundsvideobot** - ะฟัะพะฒะตัะบะฐ ะฟะพะดะฟะธัะบะธ ะฝะฐ ะบะฐะฝะฐะปั

### ะงัะพ ััะฐะฝะธััั:
- ะะฝัะพัะผะฐัะธั ะพ ะฟะพะปัะทะพะฒะฐัะตะปัั
- ะะฐัััะพะนะบะธ ะฑะพัะพะฒ (ะฒะบะปััะตะฝะฐ/ะฒัะบะปััะตะฝะฐ ะฟัะพะฒะตัะบะฐ ะฟะพะดะฟะธัะบะธ)
- ะะฐะผะฟะฐะฝะธะธ ัะฟะพะฝัะพัะพะฒ (ะบะฐะฝะฐะปั ะดะปั ะฟะพะดะฟะธัะบะธ)
- ะกัะฐัะธััะธะบะฐ ะฟะพะปัะทะพะฒะฐัะตะปะตะน

### ะะฐะถะฝะพ:
- **NowControllerBot ัะพะทะดะฐะตั ััั ะะ ะฟัะธ ะฟะตัะฒะพะผ ะทะฐะฟััะบะต**
- **NowControllerBot ะธะฝะธัะธะฐะปะธะทะธััะตั ะทะฐะฟะธัะธ ะดะปั ะฒัะตั ะฑะพัะพะฒ** ะธะท `NOWCONTROLLERBOT_BROADCAST_BOTS`
- ะััะฐะปัะฝัะต ะฑะพัั ัะพะปัะบะพ ัะธัะฐัั/ะพะฑะฝะพะฒะปััั ะดะฐะฝะฝัะต

## ๐ข ะะฝัััะตะฝะฝะธะต ะะ ะฑะพัะพะฒ

### 1. ContentFabrikaBot: `contentfabrikabot/db.sqlite`

**ะะดะต ะฝะฐัะพะดะธััั:**
```
contentfabrikabot/db.sqlite
```

**ะงัะพ ััะฐะฝะธััั:**
- ะะฐะฝะฐะปั (channels) - ะธะฝัะพัะผะฐัะธั ะพ Telegram ะบะฐะฝะฐะปะฐั
- ะัะพัะธะปะธ ััะธะปั (style_profiles) - ััะธะปั ะฝะฐะฟะธัะฐะฝะธั ะฐะฒัะพัะพะฒ
- ะะพััั ะบะฐะฝะฐะปะพะฒ (channel_posts) - ัะพััะฐะฝะตะฝะฝัะต ะฟะพััั ะดะปั ะฐะฝะฐะปะธะทะฐ ััะธะปั

**ะะธะณัะฐัะธะธ:**
- `CreateChannel` - ัะพะทะดะฐะตั ัะฐะฑะปะธัั ะบะฐะฝะฐะปะพะฒ
- `CreateStyleProfile` - ัะพะทะดะฐะตั ัะฐะฑะปะธัั ะฟัะพัะธะปะตะน ััะธะปั
- `CreateChannelPost` - ัะพะทะดะฐะตั ัะฐะฑะปะธัั ะฟะพััะพะฒ

**ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต:**
- ะะ ัะพะทะดะฐะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะธ ะฟะตัะฒะพะผ ะทะฐะฟััะบะต
- ะะธะณัะฐัะธะธ ะฟัะธะผะตะฝััััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะตัะตะท `app.autoMigrate()`

### 2. Neurfotobot: `Neurfotobot/db.sqlite`

**ะะดะต ะฝะฐัะพะดะธััั:**
```
Neurfotobot/db.sqlite
```

**ะงัะพ ััะฐะฝะธััั:**
- ะะพะดะตะปั ะฟะพะปัะทะพะฒะฐัะตะปั (UserModel) - ะธะฝัะพัะผะฐัะธั ะพ ะฟะพะปัะทะพะฒะฐัะตะปัั ะฑะพัะฐ

**ะะธะณัะฐัะธะธ:**
- `CreateUserModel` - ัะพะทะดะฐะตั ัะฐะฑะปะธัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน

**ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต:**
- ะะ ัะพะทะดะฐะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะธ ะฟะตัะฒะพะผ ะทะฐะฟััะบะต
- ะะธะณัะฐัะธะธ ะฟัะธะผะตะฝััััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะตัะตะท `app.autoMigrate()`

## ๐ ะะพััะดะพะบ ะทะฐะฟััะบะฐ

### ะ docker-compose.prod.yml:

```yaml
# NowControllerBot - ะทะฐะฟััะบะฐะตััั ะฟะตัะฒัะผ
nowcontrollerbot:
  # ... ะบะพะฝัะธะณััะฐัะธั ...
  healthcheck:
    test: ["CMD", "curl", "-f", "http://localhost:8084/health"]
    # ...

# ะัะต ะพััะฐะปัะฝัะต ะฑะพัั ะทะฐะฒะธััั ะพั NowControllerBot
roundsvideobot:
  depends_on:
    nowcontrollerbot:
      condition: service_healthy  # ะะดะตั ะฟะพะบะฐ NowControllerBot ััะฐะฝะตั ะทะดะพัะพะฒัะผ

nowmttbot:
  depends_on:
    nowcontrollerbot:
      condition: service_healthy

# ะ ัะฐะบ ะดะฐะปะตะต ะดะปั ะฒัะตั ะฑะพัะพะฒ...
```

### ะงัะพ ััะพ ะทะฝะฐัะธั:

1. **NowControllerBot ะทะฐะฟััะบะฐะตััั ะฟะตัะฒัะผ**
2. **ะััะฐะปัะฝัะต ะฑะพัั ะถะดัั** ะฟะพะบะฐ NowControllerBot ััะฐะฝะตั ะทะดะพัะพะฒัะผ (healthcheck ะฟัะพะนะดะตั)
3. **ะขะพะปัะบะพ ะฟะพัะปะต ััะพะณะพ** ะทะฐะฟััะบะฐัััั ะพััะฐะปัะฝัะต ะฑะพัั

### ะะพัะตะผั ััะพ ะฒะฐะถะฝะพ:

- NowControllerBot ัะพะทะดะฐะตั `monetization.sqlite` ะฟัะธ ะฟะตัะฒะพะผ ะทะฐะฟััะบะต
- NowControllerBot ะธะฝะธัะธะฐะปะธะทะธััะตั ะทะฐะฟะธัะธ ะดะปั ะฒัะตั ะฑะพัะพะฒ
- ะััะฐะปัะฝัะต ะฑะพัั ะผะพะณัั ะฑะตะทะพะฟะฐัะฝะพ ัะธัะฐัั ะะ ะฟะพัะปะต ััะพะณะพ

## ๐พ ะะดะต ััะฐะฝัััั ะะ ะฝะฐ ัะตัะฒะตัะต

### Volumes ะฒ docker-compose.prod.yml:

```yaml
# ะะฑัะฐั ะะ ะผะพะฝะตัะธะทะฐัะธะธ
nowcontrollerbot:
  volumes:
    - ./config/monetization.sqlite:/app/config/monetization.sqlite

# ะะฝัััะตะฝะฝัั ะะ ContentFabrikaBot
contentfabrikabot:
  volumes:
    - ./contentfabrikabot/db.sqlite:/app/contentfabrikabot/db.sqlite
```

### ะะฐ ัะตัะฒะตัะต:

ะะ ัะฐะนะปั ััะฐะฝัััั **ะฝะฐ ัะพััะต** (ะฝะต ะฒ ะบะพะฝัะตะนะฝะตัะต):
- `./config/monetization.sqlite` - ะพะฑัะฐั ะะ ะผะพะฝะตัะธะทะฐัะธะธ
- `./contentfabrikabot/db.sqlite` - ะะ ContentFabrikaBot

**ะััั ะฝะฐ ัะตัะฒะตัะต:**
```
/root/Telegrambot/config/monetization.sqlite
/root/Telegrambot/contentfabrikabot/db.sqlite
```

### ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต:

- ะะ ัะฐะนะปั **ัะพะทะดะฐัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ** ะฟัะธ ะฟะตัะฒะพะผ ะทะฐะฟััะบะต ะฑะพัะพะฒ
- ะะต ะฝัะถะฝะพ ัะพะทะดะฐะฒะฐัั ะธั ะฒัััะฝัั
- ะัะปะธ ัะฐะนะปะฐ ะฝะตั - ะฑะพั ัะพะทะดะฐัั ะตะณะพ ัะฐะผ

## โ ะัะพะณะพะฒะฐั ััะตะผะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  NowControllerBot (ะฟะตัะฒัะน!)         โ
โ  ะกะพะทะดะฐะตั: monetization.sqlite        โ
โ  ะะฝะธัะธะฐะปะธะทะธััะตั ะทะฐะฟะธัะธ ะดะปั ะฑะพัะพะฒ    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะััะฐะปัะฝัะต ะฑะพัั (ะทะฐะฟััะบะฐัััั ะฟะพัะปะต) โ
โ  ะงะธัะฐัั: monetization.sqlite        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ContentFabrikaBot                  โ
โ  ะกะพะทะดะฐะตั: contentfabrikabot/db.sqliteโ
โ  (ัะฒะพั ะฒะฝัััะตะฝะฝัั ะะ)               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ง ะะฐัััะพะนะบะฐ

### ะะตัะตะผะตะฝะฝะฐั ะพะบััะถะตะฝะธั:

```env
MONETIZATION_DB_PATH=config/monetization.sqlite
```

ะะพะถะฝะพ ะฟะตัะตะพะฟัะตะดะตะปะธัั ะฟััั ะบ ะพะฑัะตะน ะะ, ะฝะพ ะฟะพ ัะผะพะปัะฐะฝะธั ะธัะฟะพะปัะทัะตััั `config/monetization.sqlite`.

## ๐ ะงะตะบะปะธัั ะฟะตัะตะด ะทะฐะฟััะบะพะผ

- [x] NowControllerBot ะฝะฐัััะพะตะฝ ะฒ docker-compose (ะทะฐะฟััะบะฐะตััั ะฟะตัะฒัะผ)
- [x] ะัะต ะฑะพัั ะทะฐะฒะธััั ะพั NowControllerBot (`depends_on: service_healthy`)
- [x] Volumes ะฝะฐัััะพะตะฝั ะดะปั ะะ ัะฐะนะปะพะฒ
- [ ] ะะ ัะฐะนะปั ัะพะทะดะฐะดัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะธ ะฟะตัะฒะพะผ ะทะฐะฟััะบะต

## ๐ฏ ะัะพะณ

1. **ะะฑัะฐั ะะ**: `config/monetization.sqlite` - ะธัะฟะพะปัะทัะตััั ะฒัะตะผะธ ะฑะพัะฐะผะธ ะดะปั ะผะพะฝะตัะธะทะฐัะธะธ
2. **ะะฝัััะตะฝะฝะธะต ะะ**: `contentfabrikabot/db.sqlite` - ัะฒะพั ะะ ะดะปั ContentFabrikaBot
3. **ะะพััะดะพะบ ะทะฐะฟััะบะฐ**: NowControllerBot ะฟะตัะฒัะน (ัะพะทะดะฐะตั ะะ), ะพััะฐะปัะฝัะต ะฟะพัะปะต
4. **ะฅัะฐะฝะตะฝะธะต**: ะะ ัะฐะนะปั ะฝะฐ ัะพััะต, ะผะพะฝัะธัััััั ะฒ ะบะพะฝัะตะนะฝะตัั ัะตัะตะท volumes
5. **ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต**: ะะ ัะพะทะดะฐัััั ะฟัะธ ะฟะตัะฒะพะผ ะทะฐะฟััะบะต, ะฝะต ะฝัะถะฝะพ ัะพะทะดะฐะฒะฐัั ะฒัััะฝัั

ะัั ะฝะฐัััะพะตะฝะพ ะฟัะฐะฒะธะปัะฝะพ! ๐

